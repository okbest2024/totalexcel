# Excel数据提取与转移工具

该工具用于从"日报.xlsx"文件中提取特定数据，并将其转移至"202504-例会模板.xlsx"文件中的对应位置。

## 功能

1. 在"日报.xlsx"中查找"小计（含股基、港股通、北交所、期权、债券、回购等）"合并单元格
2. 在该合并单元格的列范围内找到"当年"单元格
3. 获取"当年"单元格下方的第一个非空数值（即使有空行也能正确提取）
4. 将该数值拷贝到"202504-例会模板.xlsx"中"代理买卖业务净收入（万元）"对应的目标列
5. 找到"日报.xlsx"中"当日余额（亿元）"列范围内的"融资融券余额"下方的第一个非空值，并拷贝到模板文件中"最新双融余额规模（时点，万元）"对应的目标列
6. 找到"日报.xlsx"中"全年累计日均余额（亿元）"列范围内的"融资融券余额"下方的第一个非空值，并拷贝到模板文件中"最新双融余额规模（日均，万元）"对应的目标列
7. 找到"日报.xlsx"中"有效客户数（户）"列范围内的"当年新增"下方的第一个非空值（即使是合并单元格或有空行），并拷贝到模板文件中"新增有效户（不折算）"对应的目标列
8. 找到"日报.xlsx"中"有效客户数（户）"列范围内的"当年新增"下方的第一个非空值，并拷贝到模板文件中"新增客户期末流通净资产"对应的目标列

## 使用方法

1. 确保以下文件存在于同一目录下：
   - `日报.xlsx`：源数据文件
   - `202504-例会模板.xlsx`：目标模板文件
   - `excel_data_transfer.py`：脚本文件

2. 安装所需依赖库：
   ```
   pip install -r requirements.txt
   ```

3. 运行脚本：
   ```
   python excel_data_transfer.py
   ```

4. 脚本执行完成后，会生成一个名为`202504-例会模板_已更新.xlsx`的新文件，其中包含已更新的数据。

## 脚本说明

- 源代码文件：`excel_data_transfer.py`
- 依赖库：`openpyxl`
- 脚本采用灵活的文本匹配方式，可以处理各种Excel文件格式
- 支持跳过空行，能够处理合并单元格，可靠地找到数据

## 特殊处理

1. "当年新增"往往是合并单元格，下方可能有一个空行，脚本会智能查找下方的第一个非空值
2. 脚本优先查找KA列的"当年新增"，因为根据文件结构，这是最可靠的位置
3. 查找"当年"时，会优先在"小计"附近查找，确保找到正确的列位置

## 注意事项

1. 脚本不会修改原始的"日报.xlsx"和"202504-例会模板.xlsx"文件
2. 如果找不到某些数据，对应的字段将保持为空
3. 确保Excel文件未被其他程序锁定
4. 确保有足够的磁盘空间来保存新生成的文件
5. 运行日志会详细记录查找过程，便于排查问题 